<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Historical CO2 Emissions By Country</title>
    <meta charset="UTF-8">
    <title>MCS DS - CS 498 Data Visualization Week 7 Assigment</title>
    <link rel="stylesheet" href="co2emissions.css"></link>
    <script src="d3.v4.min.js"></script>
    <script src="queue.v1.min.js"></script>
    <script src="topojson.v1.min.js"></script>
    <script src="d3-annotation.js"></script>
    <script src="d3-tip.js"></script>
    <script src="co2emissions.js"></script>
    <link rel="stylesheet" href="bootstrap.min.css">
    <script src="jquery.min.js"></script>
    <script src="bootstrap.min.js"></script>
</head>
<body>
<!--<div id="background"></div>-->
<!-- Add a slider -->
<h1 style="text-align: center;font-style: oblique"> Annual CO2 emissions by Country</h1>
<div class="slidecontainer">
    <input type="range" min="1757" max="2017" value="50" class="slider" name="mySlider" id="mySlider">
    <label id="labelSlider">Move the slider for a specific year data</label></br>
    <span class="yearSlider">1757</span><span id="endSliderValue" class="yearSlider"> 2017 </span>
    <button id="playAnimation" type="button" onClick="animates()" class ="btn btn-info">
        <span class ="glyphicon glyphicon-play">  Play Again </span>
    </button>
</div>
<div id="container">
    <div id="yearCounter">
        <h2 style="text-align: center;"><span> YEAR </span></br><span id="chosenYear">  </span></h2>
    </div>
    <div id="chart">
        <!-- Create a div where the graph will take place -->
        <div id="co2em"></div>
    </div>
</div>

<script>
    // pre-defined definitions
    d3.select("#chosenYear").text(1757);
    var format = d3.format(",");
    var lowColor = 'lightgreen';
    var midColor = "orange";
    var highColor = 'red';
    var minVal = 0;
    var midVal = 14;
    var maxVal = 28;
    var yearValue = 1757;
    var interval = 1200;
    annotatedYears = ['1957'];
    var counter = 1;
    var annotations;
    // Set tooltips
    var tip = d3.tip()
        .attr('class', 'd3-tip')
        .offset([-10, 0])
        .html(function (d) {
            // console.log("d is" , JSON.stringify(d));
            return "<strong>Country: </strong><span class='details'>" + d.properties.name + "<br></span>" +
                "<strong>Total CO2emissions: </strong><span class='details'>" + format(d.CO2emissions) + "</span>";
        });
    //set margins
    var margin = {top: -150, right: 110, bottom: 0, left: 20},
        width = 1560 - margin.left - margin.right,
        height = 500 - margin.top - margin.bottom;
    var ramp = d3.scaleQuantize().domain([minVal, midVal, maxVal]).range([lowColor, midColor, highColor]);
    var path = d3.geoPath();
    var svg = d3.select("#co2em")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .append('g')
        .attr('class', 'map');
    var projection = d3.geoMercator()
        .scale(130)
        .translate([width / 2, height / 1.5]);
    var path = d3.geoPath().projection(projection);
    svg.call(tip);
    var allCO2Data = {};
    var allWorldJson = {};
    var selectedValue = "1757";
    // Listen to the slider?
    d3.select("#mySlider").on("change", function (d) {
        d3.select("#chosenYear").text(this.value);
        console.log("selected valued", this.value);
        selectedValue = this.value;
        console.log("selected valued", selectedValue);
        updateChart(allCO2Data, allWorldJson, selectedValue);
    })
</script>
</body>
</html>